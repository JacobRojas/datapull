<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Data Tools">
        <link rel="canonical" href="https://homeaway.github.io/datapull/emr_runbook/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Running DataPull on AWS EMR - DataPull Documentation</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">DataPull Documentation</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../architecture/" class="nav-link">Architecture</a>
                            </li>
                            <li class="navitem">
                                <a href="../install_on_aws/" class="nav-link">Installing DataPull on AWS Fargate and S3</a>
                            </li>
                            <li class="navitem">
                                <a href="../aws_account_setup/" class="nav-link">Setup VPC etc. in AWS Account for DataPull install</a>
                            </li>
                            <li class="navitem">
                                <a href="../oracle_teradata_support/" class="nav-link">Add support for Oracle and Teradata</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">Running DataPull on AWS EMR</a>
                            </li>
                            <li class="navitem">
                                <a href="../transformation/" class="nav-link">Sample input JSON</a>
                            </li>
                            <li class="navitem">
                                <a href="../monitor_spark_ui/" class="nav-link">Monitor DataPull jobs using Spark UI</a>
                            </li>
                            <li class="navitem">
                                <a href="../faq/" class="nav-link">FAQs</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../oracle_teradata_support/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../transformation/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/homeaway/datapull/edit/master/docs/docs/emr_runbook.md" class="nav-link">Edit on homeaway/datapull</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#runbook-for-using-datapull-deployed-on-aws-emr" class="nav-link">Runbook for using DataPull deployed on AWS EMR</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#1-prepare-the-pipeline-json" class="nav-link">1. Prepare the Pipeline JSON</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#2-submit-the-json-to-the-api" class="nav-link">2. Submit the JSON to the API</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#3-check-status-of-the-job" class="nav-link">3. Check status of the job</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#4-get-the-email-confirmation" class="nav-link">4. Get the email confirmation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#5-check-s3-for-your-data" class="nav-link">5. Check S3 for your data</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="runbook-for-using-datapull-deployed-on-aws-emr">Runbook for using DataPull deployed on AWS EMR</h1>
<h2 id="1-prepare-the-pipeline-json">1. Prepare the Pipeline JSON</h2>
<p>1.1 Here's a sample JSON that joins Property information from SQL Server with units in cassandra and moves to s3. Please copy this to your favorite text editor</p>
<pre><code class="json">{
    &quot;useremailaddress&quot;: &quot;&lt;EMAIL_ADDRESS&gt;&quot;,
    &quot;migrations&quot;: [
        {
            &quot;sources&quot;: [
                {
                    &quot;platform&quot;: &quot;mssql&quot;,
                    &quot;server&quot;: &quot;server_name&quot;,
                    &quot;database&quot;: &quot;db_name&quot;,
                    &quot;table&quot;: &quot;properties_table&quot;,
                    &quot;login&quot;: &quot;user_id&quot;,
                    &quot;password&quot;: &quot;password&quot;,
                    &quot;alias&quot;: &quot;properties&quot;
                },
                {
                    &quot;platform&quot;: &quot;cassandra&quot;,
                    &quot;cluster&quot;: &quot;cassandra_server_name&quot;,
                    &quot;keyspace&quot;: &quot;keyspace_name&quot;,
                    &quot;table&quot;: &quot;units&quot;,
                    &quot;login&quot;: &quot;user_id&quot;,
                    &quot;password&quot;: &quot;password&quot;,
                    &quot;alias&quot;: &quot;units&quot;
                }
            ],
            &quot;destination&quot;: {
                &quot;platform&quot;: &quot;s3&quot;,
                &quot;s3path&quot;: &quot;bucket_name/path/&quot;,
                &quot;fileformat&quot;: &quot;csv&quot;
            },
            &quot;sql&quot;: {
                &quot;query&quot;: &quot;select properties.pro_id, properties.pro_city, units.unituuid from properties JOIN units ON properties.pro_id = units.propertyid limit 100&quot;
            }
        }
    ],
    &quot;cluster&quot;: {
        &quot;pipelinename&quot;: &quot;emr_cluster_name&quot;,
        &quot;awsenv&quot;: &quot;dev&quot;,
        &quot;portfolio&quot;: &quot;portfolio_name&quot;,
        &quot;product&quot;: &quot;product_name&quot;,
        &quot;ec2instanceprofile&quot;: &quot;ec2_instance_profile&quot;,
        &quot;terminateclusterafterexecution&quot;: &quot;false&quot;,
        &quot;ComponentInfo&quot;:&quot;YOUR_Component-UUID_dominion&quot;
    }
}
</code></pre>

<p>1.2 In the JSON in your text editor, please replace</p>
<ul>
<li><code>&lt;EMAIL_ADDRESS&gt;</code> with your email address.</li>
<li>database  and cluster details with your database and cluster details.</li>
</ul>
<h2 id="2-submit-the-json-to-the-api">2. Submit the JSON to the API</h2>
<p>2.1 Copy the modified JSON from your text editor, and paste it into the swagger API inputJson.
 Swagger API can be accessed through URL - http://IP-Address:8080/swagger-ui.html#!/data45pull45request45handler/startDatapull . If api is deployed in ECS FARGATE, replace the IP-Address with IP address of task of FARGATE app. If it is deployed in local, replace IP-Address with localhost. </p>
<p>2.2 Click the "Try it out!" button to queue the data pull.</p>
<h2 id="3-check-status-of-the-job">3. Check status of the job</h2>
<p>We can check the status of the job in spark UI. Spark UI runs on the master node of the EMR cluster. URL of the Spark UI will be http://master-node-IP:8088/cluster So, to find the master node IP address ,login into your AWS console, navigate to EMR service and find your cluster. If pipelinename is datapull and awsenv is dev, the cluster name will be dev-emr-datapull-pipeline. Find the IP address of the master node from hardware tab. </p>
<h2 id="4-get-the-email-confirmation">4. Get the email confirmation</h2>
<p>Wait for a few minutes, and check your email to get a confirmation when your data pull job is complete.</p>
<h2 id="5-check-s3-for-your-data">5. Check S3 for your data</h2>
<ul>
<li>Log into your AWS console.</li>
<li>Navigate to your S3 bucket.</li>
<li>Check the data under s3 path provided in the input json.</li>
</ul></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
